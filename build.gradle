buildscript {
	ext {
		springBootVersion = '2.0.1.RELEASE'
	}
	repositories {
		mavenCentral()
    jcenter()
	}
	dependencies {
		classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
	}
}

group = 'com.github.hatimiti'
version = '0.0.1-SNAPSHOT'

allprojects {
  apply plugin: 'java'
  apply plugin: 'application'
  apply plugin: 'idea'
  apply plugin: 'org.springframework.boot'
  apply plugin: 'io.spring.dependency-management'

  repositories {
  	mavenCentral()
    jcenter()
  }

  mainClassName = ''

  // Adds scope of provided 
  configurations {
    provided
  }
  sourceSets {
    main.compileClasspath += configurations.provided
    test.compileClasspath += configurations.provided
    test.runtimeClasspath += configurations.provided
  }
  test {
    classpath += configurations.provided
  }
  run {
    classpath += configurations.provided
  }
}

configure(allprojects) { project ->
  compileJava {
    sourceCompatibility = 1.8
    targetCompatibility = 1.8
    options.encoding = 'UTF-8'
  }
  compileTestJava {
    sourceCompatibility = 1.8
    targetCompatibility = 1.8
    options.encoding = 'UTF-8'
  }
}

project("spring-aspects") {
  dependencies {
  	compile('org.springframework.boot:spring-boot-starter-aop')
  	compile('org.springframework.boot:spring-boot-starter-web')
  	runtime('org.springframework.boot:spring-boot-devtools')
  	testCompile('org.springframework.boot:spring-boot-starter-test')
  }
  task runAspects(type: JavaExec) {
    main = 'com.github.hatimiti.spring.aspects.Main'
    classpath = sourceSets.main.runtimeClasspath
  }
}
